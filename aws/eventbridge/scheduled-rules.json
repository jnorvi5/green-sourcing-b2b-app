{
  "version": "1.0",
  "description": "EventBridge scheduled rules for GreenChainz Lambda functions",
  "rules": [
    {
      "name": "ec3-daily-sync",
      "description": "Trigger EC3 data sync Lambda daily at 2 AM UTC",
      "schedule_expression": "cron(0 2 * * ? *)",
      "target": {
        "type": "lambda",
        "function_name": "gc-ec3-sync",
        "input": {
          "source": "eventbridge",
          "trigger": "scheduled",
          "schedule": "daily"
        }
      },
      "state": "ENABLED",
      "tags": {
        "project": "greenchainz",
        "environment": "production",
        "purpose": "ec3-data-sync"
      }
    },
    {
      "name": "epd-weekly-sync",
      "description": "Trigger EPD International data sync Lambda weekly on Sundays at 3 AM UTC",
      "schedule_expression": "cron(0 3 ? * SUN *)",
      "target": {
        "type": "lambda",
        "function_name": "gc-epd-sync",
        "input": {
          "source": "eventbridge",
          "trigger": "scheduled",
          "schedule": "weekly"
        }
      },
      "state": "ENABLED",
      "tags": {
        "project": "greenchainz",
        "environment": "production",
        "purpose": "epd-data-sync"
      }
    },
    {
      "name": "supabase-backup",
      "description": "Trigger Supabase backup Lambda daily at 4 AM UTC",
      "schedule_expression": "cron(0 4 * * ? *)",
      "target": {
        "type": "lambda",
        "function_name": "gc-supabase-backup",
        "input": {
          "source": "eventbridge",
          "trigger": "scheduled",
          "schedule": "daily"
        }
      },
      "state": "ENABLED",
      "tags": {
        "project": "greenchainz",
        "environment": "production",
        "purpose": "database-backup"
      }
    },
    {
      "name": "cost-check",
      "description": "Trigger cost monitoring Lambda daily at 6 AM UTC",
      "schedule_expression": "cron(0 6 * * ? *)",
      "target": {
        "type": "lambda",
        "function_name": "gc-cost-monitor",
        "input": {
          "source": "eventbridge",
          "trigger": "scheduled",
          "schedule": "daily"
        }
      },
      "state": "ENABLED",
      "tags": {
        "project": "greenchainz",
        "environment": "production",
        "purpose": "cost-monitoring"
      }
    }
  ],
  "deployment": {
    "cli_commands": {
      "create_rule": "aws events put-rule --name {rule.name} --schedule-expression \"{rule.schedule_expression}\" --description \"{rule.description}\" --state {rule.state}",
      "add_target": "aws events put-targets --rule {rule.name} --targets \"Id\"=\"1\",\"Arn\"=\"arn:aws:lambda:{region}:{account_id}:function:{rule.target.function_name}\"",
      "add_permission": "aws lambda add-permission --function-name {rule.target.function_name} --statement-id {rule.name}-permission --action lambda:InvokeFunction --principal events.amazonaws.com --source-arn arn:aws:events:{region}:{account_id}:rule/{rule.name}"
    }
  }
}
